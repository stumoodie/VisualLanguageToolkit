/**
 * 
 */
package org.pathwayeditor.businessobjects.database.util;

import org.hibernate.SessionFactory;
import org.hibernate.cfg.Configuration;

/**
 * @author nhanlon 
 * Class to handle passing data to and from hibconfig
 *
 */
public class HibernateDataSource {
	public static final String HIB_PROP_DRIVER_CLASS = "hibernate.connection.driver_class";
	public static final String HIB_PROP_URL = "hibernate.connection.url";
	public static final String HIB_PROP_USERNAME = "hibernate.connection.username";
	public static final String HIB_PROP_PASSWORD = "hibernate.connection.password";
	private Configuration hibConfig;
	private String driverClass;
	private String connectionUrl;
	private String userName;
	private String password;
	/**
	 * @param xmlConfigFile with setup paramaters for Hibernate
	 */
	public HibernateDataSource(String xmlConfigFile) {
		this.hibConfig = new Configuration().configure(xmlConfigFile);
		this.driverClass = hibConfig.getProperty(HIB_PROP_DRIVER_CLASS);
		this.connectionUrl = hibConfig.getProperty(HIB_PROP_URL);
		this.userName = hibConfig.getProperty(HIB_PROP_USERNAME);
		this.password = hibConfig.getProperty(HIB_PROP_PASSWORD);
	}
	
	/**
	 * @param conn a connectioninfo object with setup paramaters for Hibernate
	 */
	public HibernateDataSource(IConnectionInfo conn) {
		hibConfig = new Configuration();
		hibConfig.setProperty(HIB_PROP_DRIVER_CLASS,conn.getDriverName());
		hibConfig.setProperty(HIB_PROP_URL,conn.getUrl());
		hibConfig.setProperty(HIB_PROP_USERNAME,conn.getUserName());
		hibConfig.setProperty(HIB_PROP_PASSWORD, conn.getPassword());
	}

	public String getDriverClass() {
		return this.driverClass;
	}

	public String getConnectionUrl() {
		return this.connectionUrl;
	}

	public String getUserName() {
		return this.userName;
	}

	public String getPassword() {
		return this.password;
	}

	/**
	 * @return hibernate sessionfactory generated by this instance (note generation is expensive and so 
	 * sessionfactory should be used as a singleton)
	 */
	public SessionFactory getSessionFactory() {
		return hibConfig.buildSessionFactory();
	}

	/**
	 * @return hibconfig  - generated by this instance
	 */
	public Configuration getHibConfig() {
		return hibConfig;
	}

}
