<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">

<hibernate-mapping>
    <class name="org.pathwayeditor.businessobjects.hibernate.pojos.HibCompoundNode" table="compoundnode" abstract="true">
        <id name="id" type="java.lang.Long">
            <column name="id" />
            <generator class="native" />
        </id>
        <properties name="xak1compoundnode" unique="true">
        	<many-to-one name="model" class="org.pathwayeditor.businessobjects.hibernate.pojos.HibModel" cascade="all">
            	<column name="model_id" not-null="false" />
        	</many-to-one>
        	<property name="index" type="int" >
        		<column name="node_index" not-null="true"/>
        	</property>
        </properties>
		
		<one-to-one name="childCompoundGraph" class="org.pathwayeditor.businessobjects.hibernate.pojos.HibSubModel" cascade="all" property-ref="rootNode"/>
		
		<set name="children" inverse="true" cascade="all,delete-orphan" collection-type="org.pathwayeditor.businessobjects.hibernate.customtypes.NodeSetType" lazy="false">
			<key column="parent_id"/>
			<one-to-many class="org.pathwayeditor.businessobjects.hibernate.pojos.HibCompoundNode" />
		</set>
		
		<many-to-one name="hibParentNode" class="org.pathwayeditor.businessobjects.hibernate.pojos.HibCompoundNode" cascade="all">
	       	<column name="parent_id" not-null="false"/>
        </many-to-one>

		<property name="isRemoved" type="boolean">
			<column name="is_removed" not-null="true"/>
		</property>

		<set name="inEdges" inverse="true" cascade="none" collection-type="org.pathwayeditor.businessobjects.hibernate.customtypes.EdgeSetType" lazy="false">
			<key column="in_node_id"/>
			<one-to-many class="org.pathwayeditor.businessobjects.hibernate.pojos.HibLinkEdge" />
		</set>
		
		<set name="outEdges" inverse="true" cascade="none" collection-type="org.pathwayeditor.businessobjects.hibernate.customtypes.EdgeSetType" lazy="false">
			<key column="out_node_id"/>
			<one-to-many class="org.pathwayeditor.businessobjects.hibernate.pojos.HibLinkEdge" />
		</set>

        <joined-subclass name="org.pathwayeditor.businessobjects.hibernate.pojos.HibRootNode" table="RootObjectNode">
			<key>
    			<column name="id" not-null="true" unique="true"/>
    		</key>
		</joined-subclass>
        
        <joined-subclass
			name="org.pathwayeditor.businessobjects.hibernate.pojos.HibShapeNode"
			table="ShapeNode">
			<key>
    			<column name="id" not-null="true" unique="true"/>
    		</key>
			<many-to-one name="attribute" class="org.pathwayeditor.businessobjects.hibernate.pojos.HibShapeAttribute" cascade="none">
		       	<column name="shape_attribute_id" not-null="false"/>
        	</many-to-one>
		</joined-subclass>
		
        <joined-subclass name="org.pathwayeditor.businessobjects.hibernate.pojos.HibLabelNode" table="LabelNode">
			<key>
    			<column name="id" not-null="true" unique="true"/>
    		</key>
			<many-to-one name="attribute" class="org.pathwayeditor.businessobjects.hibernate.pojos.HibLabelAttribute" cascade="none">
		       	<column name="label_attribute_id" not-null="false"/>
        	</many-to-one>
		</joined-subclass>
    </class>
</hibernate-mapping>
